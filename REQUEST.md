회원 관리 시스템 개발 요청서
1. 프로젝트 목표

기존의 '성당 복사단 일정 및 출석 관리' 웹 애플리케이션을 **"월별 회비 결제 및 추가 레슨비를 관리하는 회원 관리 시스템"**으로 전면 개편합니다. 최종 목표는 회원별 결제 상태를 추적하고, 월말에 실제 카드사 정산 내역과 비교하여 재정 현황을 명확히 파악하는 것입니다.

2. 데이터 모델 변경 (in db.js)

기존 데이터 구조를 회원 관리에 맞게 아래와 같이 수정 또는 추가해 주세요.

participants (회원) 저장소 수정:

status: 회원의 현재 상태를 나타내는 필드를 추가합니다. (예: active, inactive, lapsed)

nextPaymentDate: 다음 결제 예정일을 저장하는 필드를 추가합니다. (예: '2025-08-15')

memo: 회원 관련 특이사항을 기록할 수 있는 간단한 메모 필드를 추가합니다.

payments (결제 기록) 저장소 신설:

paymentId (auto-incrementing primary key)

participantId (회원 ID)

paymentDate (실제 결제일)

amount (결제 금액)

paymentType (결제 종류, 예: monthly_fee, lesson_fee)

paymentMethod (결제 수단, 예: card, cash)

settlementDate: 카드 정산이 완료된 날짜를 기록합니다.

기존 저장소 처리:

schedules, attendanceLog, scheduleState 등 기존 일정/출석 관련 저장소는 삭제하거나 새로운 시스템에 맞게 용도를 변경합니다.

3. 핵심 로직 개발 및 수정

master_data_logic.js (기준 정보 관리 로직):

기존의 엑셀 일괄 업로드, 수기 추가/수정/삭제 기능은 그대로 유지합니다.

회원 정보 추가/수정 시, 신설된 status, nextPaymentDate, memo 필드를 함께 처리할 수 있도록 로직을 확장해 주세요.

payment_logic.js (결제 관리 로직) 신설:

결제 기록: 특정 회원의 결제 정보를 payments 저장소에 추가하는 기능을 구현합니다. 결제가 기록되면 해당 회원의 nextPaymentDate를 다음 달로 자동 갱신하고, status를 'active'로 변경해야 합니다.

상태 관리: 매일 시스템 로드 시, 모든 회원의 nextPaymentDate를 확인하여 결제일이 지난 회원은 status를 'lapsed'(미납)로 자동 변경하는 로직이 필요합니다.

월말 정산 로직: 특정 월의 payments 기록을 모두 조회하여, 예상 총액, 실제 결제 총액, 카드 정산 총액, 미납 총액 등을 계산하는 함수를 구현합니다.

4. UI/UX 개편

기존 UI를 회원 관리에 적합하도록 다음과 같이 전면 개편합니다.

index.html 및 app.js (네비게이션 및 라우팅):

메인 네비게이션 메뉴를 아래와 같이 변경해 주세요.

기준정보 -> 회원정보

일정생성 -> 결제현황 (회원별)

출석현황 -> 결제현황 (일자별)

공유 -> 월말정산

설정은 그대로 유지합니다.

회원별 결제 현황 UI (기존 attendance_ui.js 재활용):

상단의 날짜 선택(년/월/일) 기능은 제거하고, 회원 이름으로 검색하는 기능을 추가합니다.

화면의 주요 내용은 회원 목록 테이블로 구성하며, 각 행은 다음 정보를 포함해야 합니다.

이름, 상태 (active/inactive/lapsed), 다음 결제 예정일, 최근 결제일, 결제 금액, 정산 여부

각 회원 행 옆에는 '결제 기록' 버튼을 두어, 버튼 클릭 시 해당 회원의 결제 내역을 추가할 수 있는 팝업(모달)을 띄워주세요.

일자별 결제 현황 UI (신설 또는 share_ui.js 재활용):

상단에 년/월/일을 선택할 수 있는 날짜 선택기를 배치합니다.

선택된 날짜를 기준으로 아래 두 목록을 명확히 구분하여 보여줍니다.

결제 완료 회원: 해당 일에 결제를 완료한 회원 목록

결제 예정/미납 회원: 해당 일이 결제 예정일이거나, 이미 결제일이 지난 미납 회원 목록

월말 정산 UI (신설):

년/월을 선택하여 해당 월의 정산 내역을 조회할 수 있습니다.

화면에 다음 정보를 명확하게 표시합니다.

예상 총 수입: (활성 회원 수 * 월 회비) + 총 레슨비

실제 결제된 총액

카드 정산 완료 총액

미납 회원 목록 및 미납 총액